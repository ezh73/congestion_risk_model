# 🏝️ 미리제주: 관광지 혼잡도·위험도 예측 프로젝트 (복원 버전)

> “모델은 실패했지만, 데이터를 설계하고 학습 구조를 구현하며 얻은 통찰이 남았다.”

---

## 📘 프로젝트 개요
**목표**  
제주도 관광지의 **혼잡도(congestion)** 및 **교통사고 위험도(risk)** 를 예측하여  
사용자가 날짜와 장소를 입력하면 하루 시간대별 위험 패턴을 확인할 수 있는 서비스를 구축.

**핵심 아이디어**  
- **혼잡도 예측:** 관광지 월 유입인구 데이터를 시뮬레이션하여 시간 단위 혼잡도를 예측  
- **위험도 예측:** 교통정보 기반 Teacher–Student 구조를 이용해 시간·공간 정보만으로 위험도를 추정  

> 본 저장소는 당시 구현했던 **모델 코드를 중심으로 복원한 버전**입니다.  
> (원본 데이터 및 대용량 Parquet 파일은 용량 문제로 제외되었습니다.)

---

## ⚙️ 기술 스택
- **데이터 처리:** Polars, Parquet, LazyFrame Streaming  
- **모델링:** LightGBM (GPU), NeuralProphet(초기 시도), Teacher–Student 지식 증류 구조  
- **피처 엔지니어링:** H3 지오해시 인코딩, 시간 주기 변환(`hour_sin`, `hour_cos`), 휴일 플래그 등  
- **환경:** Google Colab GPU / Local Python (venv)

---

## 🧩 수행 과정

### 1️⃣ 혼잡도 예측
- 제주 데이터허브의 36개 관광지 월별 유입인구 데이터를 이용  
- 개장시간, 교통량, 요일 등을 반영한 **시간대별 인구 시뮬레이션** 수행  
- LGBM과 NeuralProphet 비교 실험 → 저장·복원 문제로 NeuralProphet 중단  
- 일부 지역에서 의미 있는 변동을 보였으나 전체 적용은 실패

### 2️⃣ 위험도 예측
- 제주 ITS 교통데이터(약 1억 행)를 Polars LazyFrame으로 처리  
- Teacher 모델: 교통량 기반 위험도 학습 (LGBM Classifier)  
- Student 모델: 시간·공간 피처만 사용해 Teacher 예측을 모사 (LGBM Regressor)  
- GPU 기반 LightGBM으로 학습 안정화 및 Feature Importance 분석 수행  
- 결과: 학습은 정상적으로 수렴했지만 **모든 지역에서 예측값이 평탄하게 동일하게 출력**

---

## 📉 한계 및 실패 원인

| 문제 | 원인 | 개선 아이디어 |
|------|------|----------------|
| 지역별 예측값 평탄화 | Teacher 예측 분포 편향, 공간 피처 희소 | H3 외 추가 공간 정보(POI, 도로망 등) 도입 |
| 출력 스케일 과소 | 타깃 정규화 부재 | z-score 정규화, MinMax scaling 적용 |
| 모델 저장/복원 불안정 | NeuralProphet의 Colab 환경 이슈 | LGBM 기반 파이프라인 일원화 |

---

## 🧠 배운 점
> - Polars + Parquet 기반의 **대규모 데이터 처리 파이프라인** 직접 구축  
> - **Teacher–Student 지식 증류 구조** 설계 및 구현  
> - GPU LightGBM 환경 설정과 파라미터 최적화 경험  
> - 단순한 성능 향상보다 **데이터 설계와 피처 다양성의 중요성**을 체감  

---

## 🔭 향후 개선 방향
- `h3_enc` 외의 공간 피처(POI 밀도, 행정구역, 도로 밀도 등) 보강  
- Teacher 예측값의 스케일 조정 및 soft label 활용  
- 혼잡도/위험도 통합 예측 및 API 형태의 경량 서비스화  

---

## 💬 자기평가
> “모델은 지역별 패턴을 학습하지 못했지만,  
> 데이터 병목 해결과 모델 구조 설계, 대용량 학습 파이프라인 구축 과정을 통해  
> 실무 수준의 머신러닝 엔지니어링 역량을 체득했습니다.  
> 특히 Teacher–Student 구조를 끝까지 구현하며,  
> **데이터 설계가 모델 품질을 좌우한다는 사실**을 직접 체험했습니다.”
